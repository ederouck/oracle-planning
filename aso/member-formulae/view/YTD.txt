/* 
   ASO Member formula
   Application: Glomit
   Cube: Glomit
   Dimension: View
   Member: YTD
   Source: Oracle EPM Planning (UI copy/paste)
   Updated: 26feb2023
*/

/* NONEMPTYMEMBER [View].[Periodic]*/

CASE 
	/* Block YTD on Year_Total */
    WHEN ([Period].CurrentMember) is [YearTotal]
    THEN
    	Missing
		
    /* Balance: use closing period */
    WHEN IsUDA([Repline].CurrentMember,"Balance")
    THEN 
        IIF(IsLeaf([Period].CurrentMember), 
            [View].[Periodic],
            (ClosingPeriod([Period].Levels(0), [Period].CurrentMember), [View].[Periodic])
        )

    /* Average: average of YTD Periodic values */
    WHEN IsUDA([Repline].CurrentMember, "Average") THEN
      Avg(
        PeriodsToDate([Period].Generations(2), [Period].CurrentMember),
        ([View].[Periodic])
      )

    /* Default: Flow (or other accounts): YTD sum */
    ELSE 
        SUM(
            PeriodsToDate([Period].Generations(2), [Period].CurrentMember),
            [View].[Periodic]
        )
END